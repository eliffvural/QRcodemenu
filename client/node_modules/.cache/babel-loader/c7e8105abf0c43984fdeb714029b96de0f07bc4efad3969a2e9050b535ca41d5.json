{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\elifv\\\\Desktop\\\\QRcodemenu\\\\client\\\\src\\\\components\\\\ScanPage.js\",\n  _s = $RefreshSig$();\nimport { QrCode, RefreshCw } from 'lucide-react';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ScanPage() {\n  _s();\n  const scannerRef = useRef(null);\n  const [error, setError] = useState('');\n  const [isReady, setIsReady] = useState(false);\n  useEffect(() => {\n    let html5Qrcode;\n    let isMounted = true;\n    const startScanner = async () => {\n      try {\n        setError('');\n        if (!window.Html5Qrcode) {\n          setError('Tarayıcı kütüphanesi yüklenemedi.');\n          return;\n        }\n        const id = 'qr-reader';\n        if (!scannerRef.current) return;\n        if (!document.getElementById(id)) {\n          const div = document.createElement('div');\n          div.id = id;\n          scannerRef.current.appendChild(div);\n        }\n        html5Qrcode = new window.Html5Qrcode(id);\n        setIsReady(true);\n        await html5Qrcode.start({\n          facingMode: 'environment'\n        }, {\n          fps: 10,\n          qrbox: 250\n        }, decodedText => {\n          try {\n            // Expect URL like http://.../menu/:restaurantId\n            const url = new URL(decodedText);\n            const match = url.pathname.match(/\\/menu\\/([^/]+)/);\n            if (match && match[1]) {\n              window.location.href = `/menu/${match[1]}`;\n            } else {\n              setError('Geçersiz QR kodu. Menü bağlantısı bulunamadı.');\n            }\n          } catch (_) {\n            setError('Geçersiz QR kodu.');\n          }\n        }, scanError => {\n          // Ignore continuous scan errors\n        });\n      } catch (e) {\n        if (!isMounted) return;\n        setError('Kamera başlatılamadı. Kamera izinlerini kontrol edin.');\n      }\n    };\n    startScanner();\n    return () => {\n      isMounted = false;\n      try {\n        if (html5Qrcode) {\n          html5Qrcode.stop().catch(() => {});\n          html5Qrcode.clear().catch(() => {});\n        }\n      } catch (_) {}\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    style: {\n      padding: '30px 0'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center',\n        gap: 10\n      },\n      children: [/*#__PURE__*/_jsxDEV(QrCode, {\n        size: 28\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), \" QR ile Men\\xFC A\\xE7\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Masadaki QR kodu kameraya g\\xF6sterin. Do\\u011Frudan men\\xFC sayfas\\u0131na y\\xF6nlendirilirsiniz.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: scannerRef,\n      style: {\n        maxWidth: 420\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), !isReady && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 20\n      },\n      children: \"Haz\\u0131rlan\\u0131yor...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: 12,\n        color: '#d63031'\n      },\n      children: error\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-secondary\",\n      onClick: () => window.location.reload(),\n      style: {\n        marginTop: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(RefreshCw, {\n        size: 16\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), \" Yenile\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n_s(ScanPage, \"AlA0ddRC3yaOmW7hNu3u6dATty4=\");\n_c = ScanPage;\nexport default ScanPage;\nvar _c;\n$RefreshReg$(_c, \"ScanPage\");","map":{"version":3,"names":["QrCode","RefreshCw","React","useEffect","useRef","useState","jsxDEV","_jsxDEV","ScanPage","_s","scannerRef","error","setError","isReady","setIsReady","html5Qrcode","isMounted","startScanner","window","Html5Qrcode","id","current","document","getElementById","div","createElement","appendChild","start","facingMode","fps","qrbox","decodedText","url","URL","match","pathname","location","href","_","scanError","e","stop","catch","clear","className","style","padding","children","display","alignItems","gap","size","fileName","_jsxFileName","lineNumber","columnNumber","ref","maxWidth","marginTop","color","onClick","reload","_c","$RefreshReg$"],"sources":["C:/Users/elifv/Desktop/QRcodemenu/client/src/components/ScanPage.js"],"sourcesContent":["import { QrCode, RefreshCw } from 'lucide-react';\nimport React, { useEffect, useRef, useState } from 'react';\n\nfunction ScanPage() {\n  const scannerRef = useRef(null);\n  const [error, setError] = useState('');\n  const [isReady, setIsReady] = useState(false);\n\n  useEffect(() => {\n    let html5Qrcode;\n    let isMounted = true;\n\n    const startScanner = async () => {\n      try {\n        setError('');\n        if (!window.Html5Qrcode) {\n          setError('Tarayıcı kütüphanesi yüklenemedi.');\n          return;\n        }\n\n        const id = 'qr-reader';\n        if (!scannerRef.current) return;\n        if (!document.getElementById(id)) {\n          const div = document.createElement('div');\n          div.id = id;\n          scannerRef.current.appendChild(div);\n        }\n\n        html5Qrcode = new window.Html5Qrcode(id);\n        setIsReady(true);\n\n        await html5Qrcode.start(\n          { facingMode: 'environment' },\n          { fps: 10, qrbox: 250 },\n          (decodedText) => {\n            try {\n              // Expect URL like http://.../menu/:restaurantId\n              const url = new URL(decodedText);\n              const match = url.pathname.match(/\\/menu\\/([^/]+)/);\n              if (match && match[1]) {\n                window.location.href = `/menu/${match[1]}`;\n              } else {\n                setError('Geçersiz QR kodu. Menü bağlantısı bulunamadı.');\n              }\n            } catch (_) {\n              setError('Geçersiz QR kodu.');\n            }\n          },\n          (scanError) => {\n            // Ignore continuous scan errors\n          }\n        );\n      } catch (e) {\n        if (!isMounted) return;\n        setError('Kamera başlatılamadı. Kamera izinlerini kontrol edin.');\n      }\n    };\n\n    startScanner();\n\n    return () => {\n      isMounted = false;\n      try {\n        if (html5Qrcode) {\n          html5Qrcode.stop().catch(() => {});\n          html5Qrcode.clear().catch(() => {});\n        }\n      } catch (_) {}\n    };\n  }, []);\n\n  return (\n    <div className=\"container\" style={{ padding: '30px 0' }}>\n      <h1 style={{ display: 'flex', alignItems: 'center', gap: 10 }}>\n        <QrCode size={28} /> QR ile Menü Aç\n      </h1>\n      <p>Masadaki QR kodu kameraya gösterin. Doğrudan menü sayfasına yönlendirilirsiniz.</p>\n\n      <div ref={scannerRef} style={{ maxWidth: 420 }} />\n\n      {!isReady && (\n        <div style={{ marginTop: 20 }}>Hazırlanıyor...</div>\n      )}\n      {error && (\n        <div style={{ marginTop: 12, color: '#d63031' }}>{error}</div>\n      )}\n\n      <button\n        className=\"btn btn-secondary\"\n        onClick={() => window.location.reload()}\n        style={{ marginTop: 20 }}\n      >\n        <RefreshCw size={16} /> Yenile\n      </button>\n    </div>\n  );\n}\n\nexport default ScanPage;\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}